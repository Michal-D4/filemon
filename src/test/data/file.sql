CREATE TABLE Files (
FileID INTEGER NOT NULL PRIMARY KEY,
DirID INTEGER NOT NULL,
ExtID INTEGER,
FileName TEXT,
CommentID INTEGER,
FileDate DATE not null default '0001-01-01',
Pages INTEGER not null default 0,
Size INTEGER not null default 0,
IssueDate DATE not null default '0001-01-01',
Opened TEXT not null default '0001-01-01',
Commented DATE not null default '0001-01-01',
FOREIGN KEY(DirID) REFERENCES Dirs(DirID),
FOREIGN KEY(CommentID) REFERENCES Comments(CommentID),
FOREIGN KEY(ExtID) REFERENCES Extensions(ExtID)
)
CREATE TABLE Authors (
AuthorID INTEGER NOT NULL PRIMARY KEY,
Author TEXT
)
CREATE TABLE FileAuthor (
FileID INTEGER NOT NULL,
AuthorID INTEGER NOT NULL
)
CREATE UNIQUE INDEX FileAuthorIdx1 ON FileAuthor(FileID, AuthorID)
CREATE INDEX FileAuthorIdx2 ON FileAuthor(AuthorID)
CREATE TABLE Tags (
TagID INTEGER NOT NULL PRIMARY KEY,
Tag TEXT
)
CREATE TABLE FileTag (
FileID INTEGER NOT NULL,
TagID INTEGER NOT NULL
)
CREATE UNIQUE INDEX FileTagIdx1 ON FileTag(FileID, TagID)
CREATE INDEX FileTagIdx2 ON FileTag(TagID)
CREATE TABLE Dirs (
DirID INTEGER NOT NULL PRIMARY KEY,
Path TEXT,
ParentID INTEGER,
FolderType INTEGER,
FOREIGN KEY(ParentID) REFERENCES Dirs(DirID) ON DELETE CASCADE
)
CREATE TABLE Extensions (
ExtID INTEGER NOT NULL PRIMARY KEY,
Extension TEXT,
GroupID INTEGER
)
CREATE INDEX ExtIdx ON Extensions(GroupID)
CREATE TABLE ExtGroups (
GroupID INTEGER NOT NULL PRIMARY KEY,
GroupName TEXT
)
CREATE TABLE Comments (
CommentID INTEGER NOT NULL PRIMARY KEY,
Comment TEXT,
BookTitle TEXT
)
CREATE TABLE Log (
ActTime DATETIME,
ObjID INTEGER,
ActCode INTEGER
)
CREATE TABLE VirtDirs (
ParentID INTEGER not null,
DirID INTEGER not null,
FOREIGN KEY(ParentID) REFERENCES Dirs(DirID) ON DELETE CASCADE
)
CREATE TABLE VirtFiles (
DirID INTEGER not null,
FileID INTEGER not null,
FOREIGN KEY(DirID) REFERENCES Dirs(DirID) ON DELETE CASCADE
)
CREATE INDEX Dirs_ParentID ON Dirs(ParentID)
CREATE INDEX LogIdx ON Log(ActTime desc)
